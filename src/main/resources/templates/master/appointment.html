<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head th:replace="~{master/head :: head}"></head>

<body class="index-page">
<header id="header" class="header sticky-top">
    <div th:replace="~{master/topbar :: top_bar}"></div>
    <div th:replace="~{master/navmenu :: nav_menu}"></div>
</header>

<!--Content-->
<section id="appointment" class="appointment section light-background">
    <div class="container section-title" data-aos="fade-up">
        <h2 th:if="${appointment != null and appointment.id != null}">CHỈNH SỬA DỊCH VỤ</h2>
        <h2 th:if="${appointment == null or appointment.id == null}">ĐẶT DỊCH VỤ</h2>
    </div>

    <div class="container" data-aos="fade-up" data-aos-delay="100">
        <form th:action="@{/customer/appointment/save}" th:object="${appointment}" method="post" class="php-email-form">
            <input type="hidden" th:if="${appointment != null}" th:field="*{id}" />

            <div class="row">
                <div class="col-md-4 form-group">
                    <input type="text" th:field="*{name}" class="form-control" placeholder="Your Name" required />
                </div>
                <div class="col-md-4 form-group mt-3 mt-md-0">
                    <input type="email" th:field="*{email}" class="form-control" placeholder="Your Email" required />
                </div>
                <div class="col-md-4 form-group mt-3 mt-md-0">
                    <input type="tel" th:field="*{phone}" class="form-control" placeholder="Your Phone" required />
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 form-group mt-3">
                    <input type="datetime-local" th:field="*{date}" class="form-control" required />
                </div>
                <div class="col-md-4 form-group mt-3">
                    <select th:field="*{department}" class="form-select" required>
                        <option value="">Select Service</option>
                        <option value="Massage">Massage</option>
                        <option value="Facial">Facial</option>
                        <option value="Body">Body</option>
                        <option value="Hair">Hair</option>
                        <option value="Whitening">Whitening</option>
                        <option value="Hair-removal">Hair-removal</option>
                    </select>
                </div>
                <div class="col-md-4 form-group mt-3">
                    <select th:field="*{doctor}" class="form-select" required>
                        <option value="">Select Therapist</option>
                        <option value="Doctor Khoa">Doctor Khoa</option>
                        <option value="Doctor Linh">Doctor Linh</option>
                        <option value="Doctor Huong">Doctor Huong</option>
                        <option value="Doctor Nghia">Doctor Nghia</option>
                    </select>
                </div>
            </div>

            <div class="form-group mt-3">
                <textarea th:field="*{message}" class="form-control" rows="5" placeholder="Message (Optional)"></textarea>
            </div>
            <input type="hidden" id="username" name="username" th:value="${username}" />
            <input type="hidden" id="role" name="role" th:value="${role}" />
            <div class="mt-3">
                <div class="loading">Loading</div>
                <div class="error-message"></div>
                <div class="sent-message">Đặt lịch thành công. Cảm ơn bạn đã sử dụng dịch vụ của chúng tôi! </div>
                <div class="text-center">
                    <button type="submit" th:text="${appointment != null and appointment.id != null} ? 'Cập nhật' : 'Make an Appointment'">Đặt dịch vụ</button>
                </div>
            </div>
        </form>
    </div>
</section>
<!--/Content-->

<div th:replace="~{master/footer :: footer}"></div>
</body>
<script th:src="@{/assets/js/script.js}"></script>
<script>
    window.onload = function() {
        const username = localStorage.getItem("username");
        const role = localStorage.getItem("role");
        if (username && role) {
            document.getElementById("username").value = username;
            document.getElementById("role").value = role;
        }
    }
</script>
</html>